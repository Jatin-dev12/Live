<!-- <div class="row row-cols-xxxl-5 row-cols-lg-3 row-cols-sm-2 row-cols-1 gy-4"> -->
<div class="row">
    <div class="col-md-4 col-sm-6 mb-3 mb-md-0">
        <a href="/leads/leads-management"
            class="card shadow-none border bg-gradient-start-1 h-100 text-decoration-none">
            <div class="">
                <div class="card-body p-20">
                    <div class="d-flex flex-wrap align-items-center justify-content-between gap-3">
                        <div>
                            <p class="fw-medium text-primary-light mb-1">Total Leads</p>
                            <h6 class="mb-0">
                                <%= typeof totalLeads !=='undefined' ? totalLeads.toLocaleString() : '0' %>
                            </h6>
                        </div>
                        <div
                            class="w-50-px h-50-px bg-cyan rounded-circle d-flex justify-content-center align-items-center">
                            <!-- <iconify-icon icon="fa-solid:award" class="text-white text-2xl mb-0"></iconify-icon> -->
                            <iconify-icon icon="material-symbols-light:leaderboard-outline" width="30" height="30"
                                class="text-white text-2xl mb-0"></iconify-icon>
                        </div>
                    </div>
                    <!-- <p class="fw-medium text-sm text-primary-light mt-12 mb-0 d-flex align-items-center gap-2">
                        <span class="d-inline-flex align-items-center gap-1 text-success-main">
                            <iconify-icon icon="bxs:up-arrow" class="text-xs"></iconify-icon> +5000
                        </span>
                        Last 30 days users
                    </p> -->
                </div>
            </div><!-- card end -->
        </a>
    </div>
    <div class="col-md-4 col-sm-6 mb-3 mb-md-0  ">
        <a href="/roles/roles-management"
            class="card shadow-none border bg-gradient-start-2 h-100 text-decoration-none">
            <div class="">
                <div class="card-body p-20">
                    <div class="d-flex flex-wrap align-items-center justify-content-between gap-3">
                        <div>
                            <p class="fw-medium text-primary-light mb-1">Total Users</p>
                            <h6 class="mb-0">
                                <%= typeof totalUsers !=='undefined' ? totalUsers.toLocaleString() : '0' %>
                            </h6>
                        </div>
                        <div
                            class="w-50-px h-50-px bg-purple rounded-circle d-flex justify-content-center align-items-center">
                            <iconify-icon icon="gridicons:multiple-users"
                                class="text-white text-2xl mb-0"></iconify-icon>
                        </div>
                    </div>
                    <!-- <p class="fw-medium text-sm text-primary-light mt-12 mb-0 d-flex align-items-center gap-2">
                        <span class="d-inline-flex align-items-center gap-1 text-danger-main">
                            <iconify-icon icon="bxs:down-arrow" class="text-xs"></iconify-icon> -800
                        </span>
                        Last 30 days subscription
                    </p> -->
                </div>
            </div><!-- card end -->
        </a>
    </div>
    <div class="col-md-4 col-sm-6">
        <a href="/page-master/web-page-master"
            class="card shadow-none border bg-gradient-start-3 h-100 text-decoration-none">
            <div class="">
                <div class="card-body p-20">
                    <div class="d-flex flex-wrap align-items-center justify-content-between gap-3">
                        <div>
                            <p class="fw-medium text-primary-light mb-1">Total Pages</p>
                            <h6 class="mb-0">
                                <%= typeof totalPages !=='undefined' ? totalPages.toLocaleString() : '0' %>
                            </h6>
                        </div>
                        <div
                            class="w-50-px h-50-px bg-info rounded-circle d-flex justify-content-center align-items-center">

                            <iconify-icon icon="solar:document-text-outline"
                                class="text-white text-2xl mb-0"></iconify-icon>
                        </div>
                    </div>
                    <!-- <p class="fw-medium text-sm text-primary-light mt-12 mb-0 d-flex align-items-center gap-2">
                        <span class="d-inline-flex align-items-center gap-1 text-success-main">
                            <iconify-icon icon="bxs:up-arrow" class="text-xs"></iconify-icon> +200
                        </span>
                        Last 30 days users
                    </p> -->
                </div>
            </div><!-- card end -->
        </a>
    </div>
    <!-- <div class="col">
            <div class="card shadow-none border bg-gradient-start-4 h-100">
                <div class="card-body p-20">
                    <div class="d-flex flex-wrap align-items-center justify-content-between gap-3">
                        <div>
                            <p class="fw-medium text-primary-light mb-1">Total Income</p>
                            <h6 class="mb-0">$42,000</h6>
                        </div>
                        <div class="w-50-px h-50-px bg-success-main rounded-circle d-flex justify-content-center align-items-center">
                            <iconify-icon icon="solar:wallet-bold" class="text-white text-2xl mb-0"></iconify-icon>
                        </div>
                    </div>
                    <p class="fw-medium text-sm text-primary-light mt-12 mb-0 d-flex align-items-center gap-2">
                        <span class="d-inline-flex align-items-center gap-1 text-success-main">
                            <iconify-icon icon="bxs:up-arrow" class="text-xs"></iconify-icon> +$20,000
                        </span>
                        Last 30 days income
                    </p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card shadow-none border bg-gradient-start-5 h-100">
                <div class="card-body p-20">
                    <div class="d-flex flex-wrap align-items-center justify-content-between gap-3">
                        <div>
                            <p class="fw-medium text-primary-light mb-1">Total Expense</p>
                            <h6 class="mb-0">$30,000</h6>
                        </div>
                        <div class="w-50-px h-50-px bg-red rounded-circle d-flex justify-content-center align-items-center">
                            <iconify-icon icon="fa6-solid:file-invoice-dollar" class="text-white text-2xl mb-0"></iconify-icon>
                        </div>
                    </div>
                    <p class="fw-medium text-sm text-primary-light mt-12 mb-0 d-flex align-items-center gap-2">
                        <span class="d-inline-flex align-items-center gap-1 text-success-main">
                            <iconify-icon icon="bxs:up-arrow" class="text-xs"></iconify-icon> +$5,000
                        </span>
                        Last 30 days expense
                    </p>
                </div>
            </div>
        </div> -->

</div>

<div class="row gy-4 mt-1">
    <div class="col-xxl-12 col-xl-12">
        <div class="card h-100">
            <div class="card-body p-24">
                <div class="d-flex flex-wrap align-items-center gap-1 justify-content-between mb-16">
                    <h6 class="text-lg mb-0">Recent Leads </h6>
                    <a href="/leads/leads-management"
                        class="text-primary-600 hover-text-primary d-flex align-items-center gap-1">
                        View All
                        <iconify-icon icon="solar:alt-arrow-right-linear" class="icon"></iconify-icon>
                    </a>
                </div>

                <div class="table-responsive scroll-sm">
                    <table class="table bordered-table sm-table mb-0">
                        <thead>
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">Name</th>
                                <th scope="col">Email</th>
                                <th scope="col">Phone</th>
                                <th scope="col">Source</th>
                                <th scope="col" class="text-center">View Query</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (typeof recentLeads !=='undefined' && recentLeads.length> 0) { %>
                                <% recentLeads.forEach(lead=> { %>
                                    <tr>
                                        <td>
                                            <%= lead.createdAt ? new Date(lead.createdAt).toLocaleDateString('en-US', {
                                                year: 'numeric' , month: 'short' , day: 'numeric' }) : 'N/A' %>
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="flex-grow-1">
                                                    <span class="text-md mb-0 fw-normal text-secondary-light">
                                                        <%= lead.fullName || 'N/A' %>
                                                    </span>
                                                </div>
                                            </div>
                                        </td>
                                        <td><span class="text-md mb-0 fw-normal text-secondary-light">
                                                <%= lead.email || 'N/A' %>
                                            </span></td>
                                        <td><span class="text-md mb-0 fw-normal text-secondary-light">
                                                <%= lead.phone || 'N/A' %>
                                            </span></td>
                                        <td>
                                            <%= lead.interestedIn || 'N/A' %>
                                        </td>
                                        <td>
                                            <div class="d-flex justify-content-center align-items-center">
                                                <button type="button"
                                                    class="bg-danger-focus bg-hover-danger-200 text-danger-600 fw-medium w-40-px h-40-px d-flex justify-content-center align-items-center rounded-circle border-0 view-lead-btn"
                                                    data-lead-id="<%= lead._id %>"
                                                    data-lead-data='<%= JSON.stringify(lead) %>'>
                                                    <iconify-icon icon="majesticons:eye-line"
                                                        class="icon text-xl"></iconify-icon>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <% }) %>
                                        <% } else { %>
                                            <tr>
                                                <td colspan="6" class="text-center py-4">
                                                    <span class="text-secondary-light">No leads found</span>
                                                </td>
                                            </tr>
                                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Lead Details Modal -->
<div class="modal fade" id="leadDetailsModal" tabindex="-1" aria-labelledby="leadDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-danger-600 text-white">
                <h4 class="modal-title text-white fw-bold d-flex align-items-center gap-2 mb-0"
                    id="leadDetailsModalLabel">
                    <iconify-icon icon="mdi:account-details" class="icon" style="font-size: 32px;"></iconify-icon>
                    Lead Details
                </h4>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body p-24">
                <div class="row g-4">
                    <div class="col-12">
                        <div class="d-flex align-items-center gap-3 mb-2">
                            <iconify-icon icon="mdi:calendar" class="text-danger-600"
                                style="font-size: 28px;"></iconify-icon>
                            <label class="form-label fw-bold mb-0" style="font-size: 18px;">Date</label>
                        </div>
                        <p class="text-secondary-light ms-5 mb-0" id="modal-date"
                            style="font-size: 17px; font-weight: 600;">-</p>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center gap-3 mb-2">
                            <iconify-icon icon="mdi:account" class="text-primary-600"
                                style="font-size: 28px;"></iconify-icon>
                            <label class="form-label fw-bold mb-0" style="font-size: 18px;">Name</label>
                        </div>
                        <p class="text-secondary-light ms-5 mb-0" id="modal-fullName"
                            style="font-size: 17px; font-weight: 600;">-</p>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center gap-3 mb-2">
                            <iconify-icon icon="mdi:email" class="text-success-600"
                                style="font-size: 28px;"></iconify-icon>
                            <label class="form-label fw-bold mb-0" style="font-size: 18px;">Email</label>
                        </div>
                        <div class="ms-5">
                            <a href="#" id="modal-email" class="text-primary-600 text-decoration-none"
                                style="font-size: 17px; font-weight: 600;">-</a>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center gap-3 mb-2">
                            <iconify-icon icon="mdi:phone" class="text-warning-600"
                                style="font-size: 28px;"></iconify-icon>
                            <label class="form-label fw-bold mb-0" style="font-size: 18px;">Phone</label>
                        </div>
                        <div class="ms-5">
                            <a href="#" id="modal-phone" class="text-primary-600 text-decoration-none"
                                style="font-size: 17px; font-weight: 600;">-</a>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center gap-3 mb-2">
                            <iconify-icon icon="mdi:web" class="text-info-600" style="font-size: 28px;"></iconify-icon>
                            <label class="form-label fw-bold mb-0" style="font-size: 18px;">Interested In (Page)</label>
                        </div>
                        <p class="text-secondary-light ms-5 mb-0" id="modal-interestedIn"
                            style="font-size: 17px; font-weight: 600;">-</p>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center gap-3 mb-2">
                            <iconify-icon icon="mdi:message-text" class="text-purple-600"
                                style="font-size: 28px;"></iconify-icon>
                            <label class="form-label fw-bold mb-0" style="font-size: 18px;">Full Message</label>
                        </div>
                        <div class="ms-5 p-3 bg-neutral-50 rounded" style="max-height: 200px; overflow-y: auto;">
                            <p class="text-secondary-light mb-0" id="modal-notes"
                                style="white-space: pre-wrap; font-size: 16px; font-weight: 500; line-height: 1.6;">-
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <!-- <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                    style="font-size: 16px; font-weight: 600; padding: 10px 24px;">Close</button> -->
            </div>
        </div>
    </div>
</div>

<% script=` <script src='/js/homeOneChart.js'>
    </script>
    <script>
        // View Lead Details functionality
        document.addEventListener('DOMContentLoaded', function () {
            const viewLeadBtns = document.querySelectorAll('.view-lead-btn');

            viewLeadBtns.forEach(btn => {
                btn.addEventListener('click', function () {
                    const leadData = JSON.parse(this.getAttribute('data-lead-data'));

                    // Format and populate date
                    if (leadData.createdAt) {
                        const date = new Date(leadData.createdAt);
                        document.getElementById('modal-date').textContent = date.toLocaleDateString('en-US', {
                            year: 'numeric',
                            month: 'short',
                            day: 'numeric'
                        });
                    } else {
                        document.getElementById('modal-date').textContent = 'N/A';
                    }

                    // Populate modal with lead data
                    document.getElementById('modal-fullName').textContent = leadData.fullName || 'N/A';

                    // Make email clickable
                    const emailElement = document.getElementById('modal-email');
                    if (leadData.email && leadData.email !== 'N/A') {
                        emailElement.textContent = leadData.email;
                        emailElement.href = 'mailto:' + leadData.email;
                    } else {
                        emailElement.textContent = 'N/A';
                        emailElement.href = '#';
                        emailElement.style.pointerEvents = 'none';
                        emailElement.classList.remove('text-primary-600');
                        emailElement.classList.add('text-secondary-light');
                    }

                    // Make phone clickable
                    const phoneElement = document.getElementById('modal-phone');
                    if (leadData.phone && leadData.phone !== 'N/A') {
                        phoneElement.textContent = leadData.phone;
                        phoneElement.href = 'tel:' + leadData.phone;
                    } else {
                        phoneElement.textContent = 'N/A';
                        phoneElement.href = '#';
                        phoneElement.style.pointerEvents = 'none';
                        phoneElement.classList.remove('text-primary-600');
                        phoneElement.classList.add('text-secondary-light');
                    }

                    document.getElementById('modal-interestedIn').textContent = leadData.interestedIn || 'N/A';
                    document.getElementById('modal-notes').textContent = leadData.notes || 'No message available';

                    // Show modal
                    const modal = new bootstrap.Modal(document.getElementById('leadDetailsModal'));
                    modal.show();
                });
            });
        });
    </script>
    ` %>